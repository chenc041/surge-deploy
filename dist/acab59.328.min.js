(window.webpackJsonp=window.webpackJsonp||[]).push([[328],{1131:function(e,a,t){"use strict";t.r(a);var n=t(0),c=t.n(n),s=t(1166);a.default=function(e){const[a,t]=Object(n.useState)(!1),[l,m]=Object(n.useState)(!1);localStorage.getItem("arco-lang");return c.a.createElement("span",{style:e.style,className:"markdown-body"},c.a.createElement(s.a,null,c.a.createElement("title",null,"模拟数据 | ArcoDesign"),c.a.createElement("meta",{name:"description",content:"拦截 ajax 并返回模拟的数据"}),c.a.createElement("meta",{property:"og:title",content:"模拟数据 | ArcoDesign"}),c.a.createElement("meta",{property:"og:description",content:"拦截 ajax 并返回模拟的数据"})),c.a.createElement("div",{className:"ac-nav-intro"},c.a.createElement("p",null,"Arco Pro"),c.a.createElement("h1",{id:"模拟数据"},"模拟数据"),c.a.createElement("p",null,"拦截 ajax 并返回模拟的数据")),c.a.createElement("h2",{id:"解决方案"},"解决方案"),c.a.createElement("p",null,"前后端并行开发意味着前端需要在没有接口数据的情况下进行开发，在这种情况下如果能提供模拟数据请求的功能，我们的数据请求代码就能正常书写，pro 采用了 Mock.js 来实现这个功能。"),c.a.createElement("p",null,"Mock.js 会拦截 ajax 请求，如果有匹配的 mock 规则，就不会将 ajax 发出去，而是返回 mock 的数据。Mock.js 有着丰富的模拟数据生成方法，建议先读一下文档，文档写的很清晰易懂 ",c.a.createElement("a",{href:"http://mockjs.com/"},"MockJs 文档"),"."),c.a.createElement("pre",{className:"code_block"},c.a.createElement("code",{className:"language-js"},c.a.createElement("span",{className:"token keyword module"},"import")," ",c.a.createElement("span",{className:"token imports"},c.a.createElement("span",{className:"token maybe-class-name"},"Mock"))," ",c.a.createElement("span",{className:"token keyword module"},"from")," ",c.a.createElement("span",{className:"token string"},"'mockjs'"),c.a.createElement("span",{className:"token punctuation"},";"),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("span",{className:"token maybe-class-name"},"Mock"),c.a.createElement("span",{className:"token punctuation"},"."),c.a.createElement("span",{className:"token method function property-access"},"mock"),c.a.createElement("span",{className:"token punctuation"},"("),c.a.createElement("span",{className:"token keyword"},"new")," ",c.a.createElement("span",{className:"token class-name"},"RegExp"),c.a.createElement("span",{className:"token punctuation"},"("),c.a.createElement("span",{className:"token string"},"'/api/chatList'"),c.a.createElement("span",{className:"token punctuation"},")"),c.a.createElement("span",{className:"token punctuation"},",")," ",c.a.createElement("span",{className:"token punctuation"},"("),c.a.createElement("span",{className:"token punctuation"},")")," ",c.a.createElement("span",{className:"token arrow operator"},"=>")," ",c.a.createElement("span",{className:"token punctuation"},"{"),c.a.createElement("br",null),"  ",c.a.createElement("span",{className:"token keyword"},"const")," data ",c.a.createElement("span",{className:"token operator"},"=")," ",c.a.createElement("span",{className:"token maybe-class-name"},"Mock"),c.a.createElement("span",{className:"token punctuation"},"."),c.a.createElement("span",{className:"token method function property-access"},"mock"),c.a.createElement("span",{className:"token punctuation"},"("),c.a.createElement("span",{className:"token punctuation"},"{"),c.a.createElement("br",null),"    ",c.a.createElement("span",{className:"token string"},"'data|4-6'"),c.a.createElement("span",{className:"token operator"},":")," ",c.a.createElement("span",{className:"token punctuation"},"["),c.a.createElement("br",null),"      ",c.a.createElement("span",{className:"token punctuation"},"{"),c.a.createElement("br",null),"        ",c.a.createElement("span",{className:"token string"},"'id|+1'"),c.a.createElement("span",{className:"token operator"},":")," ",c.a.createElement("span",{className:"token number"},"1"),c.a.createElement("span",{className:"token punctuation"},","),c.a.createElement("br",null),"        username",c.a.createElement("span",{className:"token operator"},":")," ",c.a.createElement("span",{className:"token string"},"'用户7352772'"),c.a.createElement("span",{className:"token punctuation"},","),c.a.createElement("br",null),"        content",c.a.createElement("span",{className:"token operator"},":")," ",c.a.createElement("span",{className:"token string"},"'马上就开始了，好激动！'"),c.a.createElement("span",{className:"token punctuation"},","),c.a.createElement("br",null),"        time",c.a.createElement("span",{className:"token operator"},":")," ",c.a.createElement("span",{className:"token string"},"'13:09:12'"),c.a.createElement("span",{className:"token punctuation"},","),c.a.createElement("br",null),"        ",c.a.createElement("span",{className:"token string"},"'isCollect|2'"),c.a.createElement("span",{className:"token operator"},":")," ",c.a.createElement("span",{className:"token boolean"},"true"),c.a.createElement("span",{className:"token punctuation"},","),c.a.createElement("br",null),"      ",c.a.createElement("span",{className:"token punctuation"},"}"),c.a.createElement("span",{className:"token punctuation"},","),c.a.createElement("br",null),"    ",c.a.createElement("span",{className:"token punctuation"},"]"),c.a.createElement("span",{className:"token punctuation"},","),c.a.createElement("br",null),"  ",c.a.createElement("span",{className:"token punctuation"},"}"),c.a.createElement("span",{className:"token punctuation"},")"),c.a.createElement("span",{className:"token punctuation"},";"),c.a.createElement("br",null),c.a.createElement("br",null),"  ",c.a.createElement("span",{className:"token keyword control-flow"},"return")," data",c.a.createElement("span",{className:"token punctuation"},"."),c.a.createElement("span",{className:"token property-access"},"data"),c.a.createElement("span",{className:"token punctuation"},";"),c.a.createElement("br",null),c.a.createElement("span",{className:"token punctuation"},"}"),c.a.createElement("span",{className:"token punctuation"},")"),c.a.createElement("span",{className:"token punctuation"},";"))),c.a.createElement("p",null,"当客户端发送请求的 url 被 ",c.a.createElement("code",null,"new RegExp('/api/chatList')")," 匹配到，Mock.js 就会拦截这条请求，并执行对应的回调函数，返回回调函数中 return 的数据。"),c.a.createElement("blockquote",null,c.a.createElement("p",null,"注意：被 Mock.js 匹配并拦截的请求，不会出现在开发者工具的 network 面板中。")),c.a.createElement("h2",{id:"关闭-mock"},"关闭 Mock"),c.a.createElement("p",null,"为了方便开启和关闭数据模拟功能，每个 ",c.a.createElement("code",null,"Mock")," 都会被 ",c.a.createElement("code",null,"setupMock.setup")," 包裹，setupMock 如下："),c.a.createElement("pre",{className:"code_block"},c.a.createElement("code",{className:"language-js"},c.a.createElement("span",{className:"token keyword module"},"export")," ",c.a.createElement("span",{className:"token keyword module"},"default")," ",c.a.createElement("span",{className:"token keyword"},"function")," ",c.a.createElement("span",{className:"token function"},"setupMock"),c.a.createElement("span",{className:"token punctuation"},"("),"config",c.a.createElement("span",{className:"token operator"},":")," ",c.a.createElement("span",{className:"token punctuation"},"{")," ",c.a.createElement("br",null),"  mock",c.a.createElement("span",{className:"token operator"},"?"),c.a.createElement("span",{className:"token operator"},":")," boolean",c.a.createElement("span",{className:"token punctuation"},";")," ",c.a.createElement("br",null),"  ",c.a.createElement("span",{className:"token function-variable function"},"setup"),c.a.createElement("span",{className:"token operator"},":")," ",c.a.createElement("span",{className:"token punctuation"},"("),c.a.createElement("span",{className:"token punctuation"},")")," ",c.a.createElement("span",{className:"token arrow operator"},"=>")," ",c.a.createElement("span",{className:"token keyword"},"void")," ",c.a.createElement("br",null),c.a.createElement("span",{className:"token punctuation"},"}"),c.a.createElement("span",{className:"token punctuation"},")")," ",c.a.createElement("span",{className:"token punctuation"},"{"),c.a.createElement("br",null),"  ",c.a.createElement("span",{className:"token keyword"},"const")," ",c.a.createElement("span",{className:"token punctuation"},"{")," mock ",c.a.createElement("span",{className:"token operator"},"=")," ",c.a.createElement("span",{className:"token operator"},"!"),"__PRODUCTION__",c.a.createElement("span",{className:"token punctuation"},",")," setup ",c.a.createElement("span",{className:"token punctuation"},"}")," ",c.a.createElement("span",{className:"token operator"},"=")," config",c.a.createElement("span",{className:"token punctuation"},";"),c.a.createElement("br",null),c.a.createElement("br",null),"  ",c.a.createElement("span",{className:"token keyword control-flow"},"if")," ",c.a.createElement("span",{className:"token punctuation"},"("),"mock ",c.a.createElement("span",{className:"token operator"},"===")," ",c.a.createElement("span",{className:"token boolean"},"false"),c.a.createElement("span",{className:"token punctuation"},")")," ",c.a.createElement("span",{className:"token keyword control-flow"},"return"),c.a.createElement("span",{className:"token punctuation"},";"),c.a.createElement("br",null),c.a.createElement("br",null),"  ",c.a.createElement("span",{className:"token function"},"setup"),c.a.createElement("span",{className:"token punctuation"},"("),c.a.createElement("span",{className:"token punctuation"},")"),c.a.createElement("span",{className:"token punctuation"},";"),c.a.createElement("br",null),c.a.createElement("span",{className:"token punctuation"},"}"),c.a.createElement("span",{className:"token punctuation"},";"))),c.a.createElement("p",null,"非生产环境下默认启动数据模拟，当我们需要调试接口的时候只需要将 setupMock 的 mock 参数置为 false 即可，如下："),c.a.createElement("pre",{className:"code_block"},c.a.createElement("code",{className:"language-js"},c.a.createElement("span",{className:"token keyword module"},"import")," ",c.a.createElement("span",{className:"token imports"},c.a.createElement("span",{className:"token maybe-class-name"},"Mock"))," ",c.a.createElement("span",{className:"token keyword module"},"from")," ",c.a.createElement("span",{className:"token string"},"'mockjs'"),c.a.createElement("span",{className:"token punctuation"},";"),c.a.createElement("br",null),c.a.createElement("span",{className:"token keyword module"},"import")," ",c.a.createElement("span",{className:"token imports"},"setupMock")," ",c.a.createElement("span",{className:"token keyword module"},"from")," ",c.a.createElement("span",{className:"token string"},"'../utils/setupMock'"),c.a.createElement("span",{className:"token punctuation"},";"),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("span",{className:"token function"},"setupMock"),c.a.createElement("span",{className:"token punctuation"},"("),c.a.createElement("span",{className:"token punctuation"},"{"),c.a.createElement("br",null),"  mock",c.a.createElement("span",{className:"token operator"},":")," ",c.a.createElement("span",{className:"token boolean"},"false"),c.a.createElement("br",null),"  ",c.a.createElement("span",{className:"token function"},"setup"),c.a.createElement("span",{className:"token punctuation"},"("),c.a.createElement("span",{className:"token punctuation"},")")," ",c.a.createElement("span",{className:"token punctuation"},"{"),c.a.createElement("br",null),"    ",c.a.createElement("span",{className:"token comment"},"// 用户信息"),c.a.createElement("br",null),"    ",c.a.createElement("span",{className:"token maybe-class-name"},"Mock"),c.a.createElement("span",{className:"token punctuation"},"."),c.a.createElement("span",{className:"token method function property-access"},"mock"),c.a.createElement("span",{className:"token punctuation"},"("),c.a.createElement("span",{className:"token keyword"},"new")," ",c.a.createElement("span",{className:"token class-name"},"RegExp"),c.a.createElement("span",{className:"token punctuation"},"("),c.a.createElement("span",{className:"token string"},"'/api/userInfo'"),c.a.createElement("span",{className:"token punctuation"},")"),c.a.createElement("span",{className:"token punctuation"},",")," ",c.a.createElement("span",{className:"token punctuation"},"("),c.a.createElement("span",{className:"token punctuation"},")")," ",c.a.createElement("span",{className:"token arrow operator"},"=>")," ",c.a.createElement("span",{className:"token punctuation"},"{"),c.a.createElement("br",null),"      ",c.a.createElement("span",{className:"token keyword control-flow"},"return")," ",c.a.createElement("span",{className:"token punctuation"},"{"),c.a.createElement("br",null),"        name",c.a.createElement("span",{className:"token operator"},":")," ",c.a.createElement("span",{className:"token string"},"'name'"),c.a.createElement("span",{className:"token punctuation"},","),c.a.createElement("br",null),"      ",c.a.createElement("span",{className:"token punctuation"},"}"),c.a.createElement("span",{className:"token punctuation"},";"),c.a.createElement("br",null),"    ",c.a.createElement("span",{className:"token punctuation"},"}"),c.a.createElement("span",{className:"token punctuation"},")"),c.a.createElement("span",{className:"token punctuation"},";"),c.a.createElement("br",null),"  ",c.a.createElement("span",{className:"token punctuation"},"}"),c.a.createElement("span",{className:"token punctuation"},","),c.a.createElement("br",null),c.a.createElement("span",{className:"token punctuation"},"}"),c.a.createElement("span",{className:"token punctuation"},")"),c.a.createElement("span",{className:"token punctuation"},";"))))}}}]);